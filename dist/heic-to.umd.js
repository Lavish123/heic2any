!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).HeicTo={})}(this,(function(e){"use strict";let t;const a=async e=>new Promise(((a,r)=>{(()=>{if(!t){const e=WORKER_FILE_CONTENT,a=new Blob([e],{type:"application/javascript"});t=new Worker(URL.createObjectURL(a)),t.onerror=e=>console.error("Worker error:",e)}})();const n=(Math.random()*(new Date).getTime()).toString(),o={id:n,buffer:e};t.postMessage(o);const i=e=>{if(e.data.id===n)return e.currentTarget.removeEventListener("message",i),e.data.error?r(e.data.error):a(e.data.imageData)};t.addEventListener("message",i)}));e.heicTo=async({blob:e,type:t,quality:r})=>{const n=await e.arrayBuffer(),o=await(async e=>{const t=await a(e),r=document.createElement("canvas");return r.width=t.width,r.height=t.height,r.getContext("2d").putImageData(t,0,0),r})(n);return await new Promise(((e,a)=>o.toBlob((t=>{null!=t?e(t):a("Can't convert canvas to blob.")}),t,r)))},e.isHeic=async e=>{const t=(await e.arrayBuffer()).slice(8,12);switch(new TextDecoder("utf-8").decode(t).replace("\0"," ").trim()){case"mif1":case"msf1":case"heic":case"heix":case"hevc":case"hevx":return!0}return!1},Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=heic-to.umd.js.map
